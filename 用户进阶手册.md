
* 脚本中有哪些内置变量
* 调度中心
  * 配置项与资源项有什么用途
  * 如何配置hadoop的ugi
  * 配置项有哪些种类(环境变量/Hadoop/加密/内置配置项)
  * 权限系统介绍
  * 任务/目录 如何迁移
  * 任务依赖关系与问题排查思路
  * 如何关注任务/目录(接收报警)
* 开发中心
  * 全局配置有什么用
  * 如何上传资源

***

* 脚本中有哪些内置变量  
在脚本中我们预先定义了一些常用变量，方便使用  
${zdt}：日期变量（ZeusDateTool），用于日期的格式化输出，相当于Java中的Date对象  
输出年月日格式可以使用： ${zdt.format("yyyyMMdd")}  
输出昨天的年月日时秒分：${zdt.addDay(-1).format("yyyyMMdd hh:mm:ss")}  
${yesterday}: 表示昨天的yyyyMMdd格式，相当于${zdt.addDay(-1).format("yyyyMMdd")}  
* 调度中心  
  * 配置项与资源项有什么用途  
  每一个组或者任务上面都会有配置项和资源项  
  配置项是一个key=value格式的文本，在编辑时可以填写。可填写的内容参见后面的介绍  
  资源项代表的是资源附件，通过上传资源的方式，来自动填写资源项  
  任务在执行之前都会将资源下载到当前目录，然后再启动任务  
  配置项和资源项都具有继承的特性，在左侧的任务树结构中，上层的配置项和资源项会被下层的组或者任务继承  
  因此对于一些公共的配置项或者资源项可以提取到上层组上进行配置  
  配置项和资源项也具有覆盖的特性  
  如果下层的配置项和上层的配置项都填写了通一个key的配置，那么下层的配置将会覆盖上层配置  
  * 如何配置hadoop的ugi  
  hadoop集群有账号和组，用于分配运算资源和权限，一般在core-site.xml中配置hadoop.job.ugi=xxx来设定  
  在宙斯系统中通过配置项的方式可以非常方便的对每一个任务进行配置  
  比如在某一个任务的配置项中添加： core-site.hadoop.job.ugi=xxx (注意前面多了一个core-site. 前缀)
  也可以将这个配置项放在组上，那么组下所有的任务都会继承到这个配置项  
  ugi配置项的值中包含了一个敏感信息：密码  
  当界面展示时会隐藏掉密码部分,用星号*来替代密码，比如： core-site.hadoop.job.ugi=zeus,group-zues#* 当进入编辑状态时即可看到真实的密码了  
  除此之外所有的hadoop配置项都可以以这样的方式进行配置。  
  如果配置项想加入core-site.xml中，则加core-site. 前缀，如果想加入hdfs-site.xml中，则加hdfs-site. 前缀，以此类推  
  * 配置项中有哪些类型  
  上一段已经说明了，配置项中可以配置hadoop的配置，除此之外还能配置一些其他的配置：  
  环境变量： 配置项中以instance. 开头的配置项将会被放入环境变量  
  加密： 部分配置项涉及敏感信息，比如数据库账号密码等等。使用screct. 开头的配置项，在展示时会进行隐藏，使用星号代替  
  内置配置项： 
  ```java
  //MapReduce 中可以使用的配置项
  java.classpath=xxx //设置java任务的Classpath
  java.main.args=xxx //设置入口main方法的传入参数
  java.Xms=xxx //设置jvm参数
  java.Xmx=xxx //jvm参数
  java.jvm.args //jvm启动参数
  
  zeus.secret.script=true/false //脚本加密，设置为true后，没有管理员权限的人员无法看到脚本内容。支持继承特性
  ```
  配置项中以 instance. 或 secret. 开头的配置项，在脚本中可以直接引用。  
  比如配置 secret.password=12345 则在脚本中可以使用  ${secret.password}  
  * 权限系统介绍  
  宙斯系统的权限系统有如下几种角色  
  超级管理员：最高权限，由系统管理员配置  
  所有人： 组或者任务的创建者，自动成为该组或者任务的所有人，对组或者任务有最高权限  
  管理员： 所有人可以为组或者任务添加其他管理员，管理员没有再次分配给其他人管理员的权限  
  围观群众：普通用户，一般来说对任务有查看权限，但是没有编辑执行等权限  
  权限系统也具有继承特性，上层组的所有人或者管理员，自动具备下层组的权限  
  * 任务/组 如何迁移  
  在任务或者组创建后，可能需要重新整理分组，宙斯支持对任务或者组进行移动操作  
  移动操作只能在“所有的调度任务”Tab下使用，你必须具备源组和目标组的管理员权限，才能进行移动操作  
  操作方法很简单，直接进行拖拽即可  
  在移动任务或者组时，必须要考虑配置项和资源项的继承问题  
  假设你的任务使用了上层继承下来的配置项或者资源，当你的任务被移到其他组时，可能会导致配置项或者资源项的丢失。此处需要自己注意  
  * 任务依赖关系与问题排查  
  宙斯支持任务的依赖设置，而且不限深度  
  依赖任务的执行顺序是自底向上的。因此只有最底层的任务可以设置调度周期，上层的任务会在底层任务执行完毕后自动触发，无需设置调度时间。  
  当多任务依赖时，可能会出现异常，需要用额外的依赖周期来进行配置  
  比如任务D 分别依赖A,B,C ,假设这是一个每天都执行的任务。  
  假设在第一天A,B成功执行，C没有执行。那么第一天无法触发D执行，到了第二天C执行成功，此时A,B还没有执行。但是D收到C的成功消息后，认为集齐了A,B,C的任务，将会触发D执行。
  D的触发在我们看来是一个异常，因为第二天的A,B还没有执行，会导致D异常失败。  
  为了解决这个问题，我们需要增加一个依赖周期的概念，我们需要为任务D增加一个依赖周期，配置为：同一天  
  如此配置后，同一个案例，当第二天D收到C的成功消息后。发现A,B,C都成功了，然后对A,B,C的成功时间进行计算，发现A,B的成功时间是昨天的，则认为A,B的消息已经失效了，丢弃掉。
  最后D只记录到C成功了，还会继续等待A,B任务的成功，才会触发。  
  目前的依赖周期只有“同一天”，后续如果需求其他类型的，则需要自己升级添加。就我们的经验来说，大部分都是每日运行的，基本可以解决这个问题。  
  如果你碰到了依赖调度任务的异常启动，也可以通过界面去观察一下依赖任务的准备情况  
  查看位置是：选中任务的上层组，进入“总览”，在列表中找到任务id，有一个字段写这依赖任务的准备状态。通过此状态可以分析异常触发原因。  
  * 如何关注任务/组 （接收报警）  
  此处需要管理员进行预先配置，保证报警系统能够正常运行，配置方法参见 管理员配置手册  如果未事先配置，则以下方法都无法生效  
  所有任务的所有人，默认强制接收该任务的自动调度失败报警  
  主动接收其他任务的报警信息，可以通过在左侧任务树上右键的方式进行关注(或者取消关注)，当你关注了这个任务的时候，这个任务的自动调度失败报警将会发送给你。  
  报警具有继承特性，如果你关注了上层组，那么你将会收到所有组下的任务的报警  
* 开发中心  
  * 全局配置有什么用  
  打开开发中心的sh文档或者hive文档，在菜单栏会有一个全局配置  
  全局配置与配置项类似，是一个key=value的结构，可以配置hadoop的信息  
  全局配置中的内容对开发中心的所有文档都产生影响。你无法针对单个文档进行配置  
  * 如何上传资源  
  在菜单栏的扩展功能中，可以选择上传资源附件  
  上传成功后脚本区域会自动添加一条类似 [download:xx] 的文本  
  请不要删除此行，任务在运行时会根据此行，先进行下载操作，然后再执行脚本  
  
  
  